<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Map Engine Pro</title>
    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Log overlay -->
<div id="map-log" class="log-overlay">
    <div class="log-header">
        <span>Engine Logs</span>
        <div class="log-header-btns">
            <button class="btn-log-action" onclick="clearLogs()">Clear</button>
            <button class="btn-log-action" onclick="copyLogs()">Copy</button>
            <button class="btn-log-action btn-log-minimise" onclick="toggleLogMinimise()">âˆ’</button>
        </div>
    </div>
    <div id="log-content"></div>
</div>

<!-- Fact card -->
<div id="fact-box">
    <p id="fact-body">Main Fact</p>
    <div id="fact-details">Details go here...</div>
</div>

<!-- Main panel -->
<div id="panel-wrapper">
  <div id="config-panel">

    <!-- â”€â”€ TABS â”€â”€ -->
    <div class="tab-bar">
        <button class="tab-btn tab-active" data-tab="tour"      onclick="switchTab('tour')">Tour</button>
        <button class="tab-btn"            data-tab="customize" onclick="switchTab('customize')">Customize</button>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOUR TAB -->
    <div id="tab-tour" class="tab-content">

        <div id="regional-section" class="field">
            <label>State / Province Data Packs</label>
            <p class="hint-text" style="margin-bottom:6px">Load before using State rows. Fetched once &amp; cached.</p>
            <div class="select-wrapper">
                <select id="countrySelect" onchange="addCountryTag()">
                    <option value="" disabled selected>Add Country Pack...</option>
                    <option value="usa">USA</option>
                    <option value="ind">India</option>
                    <option value="jpn">Japan</option>
                    <option value="aus">Australia</option>
                    <option value="can">Canada</option>
                    <option value="deu">Germany</option>
                    <option value="gbr">United Kingdom</option>
                    <option value="fra">France</option>
                    <option value="esp">Spain</option>
                    <option value="rus">Russia</option>
                    <option value="chn">China</option>
                </select>
            </div>
            <div id="tag-container" class="tag-container"></div>
        </div>

        <div class="field">
            <div class="csv-label-row">
                <label id="csvLabel" style="margin:0">Location List</label>
                <button class="btn-shuffle" onclick="shuffleCSV()" title="Load a random sample dataset">&#9684; Shuffle</button>
            </div>
            <p id="csvHint" class="hint-text">Format: Type, Name, Origin, Color, Fact, Details, Size, Label, ShowFact, Persist, PersistLabel, RecencyMode &nbsp;|&nbsp; Origin: empty for polygons, country/region for cities</p>
            <textarea id="locationInput">Country, India, , #e67e22, The Subcontinent, World's most populous country, 2, false, true, false, false, false
State, Maharashtra, , #e74c3c, Maharashtra, Home to Mumbai â€” India's financial hub, 1.5, true, true, true, false, true
State, Karnataka, , #e74c3c, Karnataka, Silicon Valley of India, 1.5, true, true, true, false, true
City, Mumbai, India, #e74c3c, Mumbai, Financial capital of India, 10, true, true, false, false, false
City, Bengaluru, India, #3498db, Bengaluru, Silicon Valley of India, 8, true, true, false, false, false</textarea>
        </div>

        <div class="row" style="display:flex; gap:10px;">
            <div class="field" style="flex:1">
                <label>Start Zoom</label>
                <input type="number" id="startZoom" value="2" step="0.5">
            </div>
            <div class="field" style="flex:1">
                <label>Max Zoom</label>
                <input type="number" id="maxZoom" value="6" step="0.5">
            </div>
        </div>

        <div class="field">
            <label>Travel Speed (0.1 â€“ 2.0)</label>
            <input type="number" id="speed" value="0.4" step="0.1" min="0.1" max="2">
        </div>

        <div class="field">
            <label>Map Theme</label>
            <div style="display:flex; gap:5px;">
                <select id="mapTheme" style="flex:2">
                    <optgroup label="Light">
                        <option value="bright">Bright</option>
                        <option value="paper">Paper</option>
                        <option value="arctic">Arctic</option>
                        <option value="sand">Sand</option>
                        <option value="sepia">Sepia</option>
                        <option value="colorful">Colorful</option>
                    </optgroup>
                    <optgroup label="Dark">
                        <option value="dark">Dark</option>
                        <option value="midnight">Midnight</option>
                        <option value="slate">Slate</option>
                        <option value="monochrome">Monochrome</option>
                        <option value="neon">Neon</option>
                        <option value="ember">Ember</option>
                        <option value="forest">Forest</option>
                        <option value="oceanic">Oceanic</option>
                        <option value="dusk">Dusk</option>
                    </optgroup>
                </select>
                <button class="btn-refresh" onclick="applyTheme()">ðŸ”„</button>
            </div>
        </div>

        <div class="field">
            <div class="slider-label-row">
                <label style="margin:0">Stay Duration</label>
                <span class="slider-value-display"><output id="stayOutput">6</output>s</span>
            </div>
            <input type="range" id="stayDuration" min="1" max="20" value="6"
                   oninput="document.getElementById('stayOutput').value = this.value">
        </div>

        <div class="field">
            <div class="toggle-row">
                <input type="checkbox" id="showLogs" checked
                       onchange="document.getElementById('map-log').classList.toggle('log-hidden')">
                <label for="showLogs" style="margin:0; cursor:pointer;">Show Live Engine Logs</label>
            </div>
        </div>

    </div><!-- /tab-tour -->

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CUSTOMIZE TAB -->
    <div id="tab-customize" class="tab-content tab-hidden">

        <!-- Masters -->
        <div class="cx-section-title">Masters</div>
        <div class="cx-section">
            <div class="toggle-row">
                <input type="checkbox" id="cx-master-fact" checked>
                <label for="cx-master-fact">Fact Card &nbsp;<span class="cx-hint">global on/off</span></label>
            </div>
            <div class="toggle-row" style="margin-top:8px">
                <input type="checkbox" id="cx-master-label" checked>
                <label for="cx-master-label">Labels &nbsp;<span class="cx-hint">global on/off</span></label>
            </div>
            <div class="toggle-row" style="margin-top:8px">
                <input type="checkbox" id="cx-master-details" checked>
                <label for="cx-master-details">Fact Details &nbsp;<span class="cx-hint">global on/off</span></label>
            </div>
            <div class="field" style="margin-top:10px; margin-bottom:0">
                <label>Visited Region Color <span class="cx-hint">(RecencyMode)</span></label>
                <div class="color-row">
                    <input type="color" id="cx-recency-color" value="#7f8c8d" class="color-swatch">
                    <input type="text"  id="cx-recency-color-hex" value="#7f8c8d" class="color-hex"
                           oninput="syncColor('cx-recency-color','cx-recency-color-hex',this.value)">
                </div>
            </div>
        </div>

        <!-- Fact Card -->
        <div class="cx-section-title">Fact Card</div>
        <div class="cx-section">
            <div class="cx-row">
                <div class="field">
                    <label>Heading Size</label>
                    <div class="unit-input"><input type="number" id="cx-heading-size" value="20" min="10" max="48"><span>px</span></div>
                </div>
                <div class="field">
                    <label>Heading Color</label>
                    <div class="color-row">
                        <input type="color" id="cx-heading-color" value="#1a1a1a" class="color-swatch"
                               oninput="document.getElementById('cx-heading-color-hex').value=this.value">
                        <input type="text"  id="cx-heading-color-hex" value="#1a1a1a" class="color-hex"
                               oninput="syncColor('cx-heading-color','cx-heading-color-hex',this.value)">
                    </div>
                </div>
            </div>
            <div class="cx-row">
                <div class="field">
                    <label>Details Size</label>
                    <div class="unit-input"><input type="number" id="cx-details-size" value="13" min="8" max="32"><span>px</span></div>
                </div>
                <div class="field">
                    <label>Details Color</label>
                    <div class="color-row">
                        <input type="color" id="cx-details-color" value="#555555" class="color-swatch"
                               oninput="document.getElementById('cx-details-color-hex').value=this.value">
                        <input type="text"  id="cx-details-color-hex" value="#555555" class="color-hex"
                               oninput="syncColor('cx-details-color','cx-details-color-hex',this.value)">
                    </div>
                </div>
            </div>
        </div>

        <!-- Label -->
        <div class="cx-section-title">Label</div>
        <div class="cx-section">
            <div class="cx-row">
                <div class="field">
                    <label>Label Size</label>
                    <div class="unit-input"><input type="number" id="cx-label-size" value="22" min="10" max="60"><span>px</span></div>
                </div>
                <div class="field">
                    <label>Label Color</label>
                    <div class="color-row">
                        <input type="color" id="cx-label-color" value="#ffffff" class="color-swatch"
                               oninput="document.getElementById('cx-label-color-hex').value=this.value">
                        <input type="text"  id="cx-label-color-hex" value="#ffffff" class="color-hex"
                               oninput="syncColor('cx-label-color','cx-label-color-hex',this.value)">
                    </div>
                </div>
            </div>
            <div class="toggle-row" style="margin-top:4px">
                <input type="checkbox" id="cx-label-shadow" checked>
                <label for="cx-label-shadow">Label Shadow</label>
            </div>
        </div>

    </div><!-- /tab-customize -->

    <button class="btn-run" onclick="runEngine()">â–¶ START TOUR</button>

  </div><!-- /config-panel -->
  <button class="panel-arrow" id="panelArrow" onclick="toggleConfig()" title="Hide / Show panel">&#8249;</button>
</div><!-- /panel-wrapper -->

<div id="map"></div>
<script src="data/dictionary.js"></script>
<script src="data/samples.js"></script>
<script src="script.js"></script>
</body>
</html>